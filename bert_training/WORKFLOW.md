# BERT4Rec è¨“ç·´æµç¨‹åœ–

æœ¬æ–‡æª”è©³ç´°èªªæ˜ BERT4Rec æ¨¡å‹çš„å®Œæ•´è¨“ç·´æµç¨‹ã€‚

## ğŸ“Š å®Œæ•´æµç¨‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BERT4Rec è¨“ç·´å®Œæ•´æµç¨‹                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  éšæ®µ 0: ç’°å¢ƒæº–å‚™                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â–º setup.bat
         â”‚   â”œâ”€ æª¢æŸ¥ Python å®‰è£
         â”‚   â”œâ”€ å®‰è£ä¾è³´å¥—ä»¶ (requirements.txt)
         â”‚   â”œâ”€ å‰µå»ºç›®éŒ„çµæ§‹ (data/, output/)
         â”‚   â””â”€ é©—è­‰ GPU å¯ç”¨æ€§
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  éšæ®µ 1: æº–å‚™å‹•ç•«æ•¸æ“š                                                    â”‚
â”‚  åŸ·è¡Œ: 1_prepare_anime.bat                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â–º prepare_dataset.py --count 3000
         â”‚   â”‚
         â”‚   â”œâ”€ é€£æ¥ AniList API
         â”‚   â”œâ”€ æŠ“å– 3000 éƒ¨ç†±é–€å‹•ç•«
         â”‚   â”‚  â”œâ”€ æŒ‰ POPULARITY_DESC æ’åº
         â”‚   â”‚  â”œâ”€ åˆ†é æŠ“å– (æ¯é  50 éƒ¨)
         â”‚   â”‚  â””â”€ ç¸½å…± 60 é 
         â”‚   â”‚
         â”‚   â”œâ”€ æå–å‹•ç•«è³‡è¨Š
         â”‚   â”‚  â”œâ”€ ID
         â”‚   â”‚  â”œâ”€ æ¨™é¡Œ (ç¾…é¦¬å­—/è‹±æ–‡/åŸç”Ÿ)
         â”‚   â”‚  â”œâ”€ é¡å‹ã€æ ¼å¼ã€ç‹€æ…‹
         â”‚   â”‚  â”œâ”€ è©•åˆ†ã€äººæ°£
         â”‚   â”‚  â””â”€ ä¸Šæ˜ æ—¥æœŸ
         â”‚   â”‚
         â”‚   â””â”€ å„²å­˜åˆ°è³‡æ–™åº«
         â”‚       â””â”€â–º data/bert.db
         â”‚           â””â”€ bert_anime è¡¨ (3000 ç­†è¨˜éŒ„)
         â”‚
         â–¼
         
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  éšæ®µ 2: è¼‰å…¥ç”¨æˆ¶æ•¸æ“š                                                    â”‚
â”‚  åŸ·è¡Œ: 2_load_users.bat                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â–º load_users.py --min-anime 20
         â”‚   â”‚
         â”‚   â”œâ”€ è®€å–ç”¨æˆ¶åˆ—è¡¨
         â”‚   â”‚  â””â”€ datas_user.txt (æ¯è¡Œä¸€å€‹ç”¨æˆ¶å)
         â”‚   â”‚
         â”‚   â”œâ”€ å°æ¯å€‹ç”¨æˆ¶:
         â”‚   â”‚  â”œâ”€ å¾ AniList ç²å–å€‹äººè³‡æ–™
         â”‚   â”‚  â”œâ”€ ç²å–å‹•ç•«è§€çœ‹åˆ—è¡¨
         â”‚   â”‚  â”œâ”€ éæ¿¾: è‡³å°‘ 20 éƒ¨å‹•ç•«
         â”‚   â”‚  â””â”€ æå–è§€çœ‹è³‡è¨Š
         â”‚   â”‚     â”œâ”€ anime_id
         â”‚   â”‚     â”œâ”€ status (å®Œæˆ/è§€çœ‹ä¸­/è¨ˆåŠƒä¸­)
         â”‚   â”‚     â”œâ”€ score (è©•åˆ†)
         â”‚   â”‚     â””â”€ progress (è§€çœ‹é€²åº¦)
         â”‚   â”‚
         â”‚   â””â”€ å„²å­˜åˆ°è³‡æ–™åº«
         â”‚       â””â”€â–º data/bert.db
         â”‚           â””â”€ bert_user_anime_list è¡¨
         â”‚
         â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  éšæ®µ 3: æ¨¡å‹è¨“ç·´                                                        â”‚
â”‚  åŸ·è¡Œ: 3_train_model.bat æˆ– 3_train_model_gpu.bat                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â–º train_model.py --epochs 200 --batch-size 64 --gpu
         â”‚   â”‚
         â”‚   â”œâ”€ ç¬¬ä¸€æ­¥: è¼‰å…¥æ•¸æ“š
         â”‚   â”‚  â”œâ”€ å¾ data/bert.db è®€å–å‹•ç•«åˆ—è¡¨
         â”‚   â”‚  â”œâ”€ å¾ data/bert.db è®€å–ç”¨æˆ¶è§€çœ‹è¨˜éŒ„
         â”‚   â”‚  â”œâ”€ å»ºç«‹æ˜ å°„ (anime_id â†’ index)
         â”‚   â”‚  â””â”€ çµ„ç¹”ç”¨æˆ¶åºåˆ—
         â”‚   â”‚     â””â”€ [anime_1, anime_2, anime_3, ...]
         â”‚   â”‚
         â”‚   â”œâ”€ ç¬¬äºŒæ­¥: æ•¸æ“šé è™•ç†
         â”‚   â”‚  â”œâ”€ åˆ†å‰²è¨“ç·´é›†/é©—è­‰é›† (9:1)
         â”‚   â”‚  â”œâ”€ å‰µå»º BERT4RecDataset
         â”‚   â”‚  â”‚  â”œâ”€ æˆªæ–·/å¡«å……åºåˆ—åˆ° max_seq_len=200
         â”‚   â”‚  â”‚  â”œâ”€ éš¨æ©Ÿé®ç½© 15% çš„é …ç›®
         â”‚   â”‚  â”‚  â””â”€ å‰µå»º attention_mask
         â”‚   â”‚  â””â”€ å‰µå»º DataLoader
         â”‚   â”‚
         â”‚   â”œâ”€ ç¬¬ä¸‰æ­¥: å»ºç«‹æ¨¡å‹
         â”‚   â”‚  â””â”€ BERT4Rec
         â”‚   â”‚     â”œâ”€ Item Embedding (num_items + 3)
         â”‚   â”‚     â”œâ”€ Position Embedding (max_seq_len)
         â”‚   â”‚     â”œâ”€ Transformer Encoder
         â”‚   â”‚     â”‚  â”œâ”€ num_layers = 2
         â”‚   â”‚     â”‚  â”œâ”€ num_heads = 4
         â”‚   â”‚     â”‚  â””â”€ hidden_size = 256
         â”‚   â”‚     â””â”€ Output Layer (é æ¸¬ä¸‹ä¸€å€‹é …ç›®)
         â”‚   â”‚
         â”‚   â”œâ”€ ç¬¬å››æ­¥: è¨“ç·´å¾ªç’° (200 epochs)
         â”‚   â”‚  â”‚
         â”‚   â”‚  â””â”€ æ¯å€‹ Epoch:
         â”‚   â”‚     â”‚
         â”‚   â”‚     â”œâ”€ è¨“ç·´éšæ®µ
         â”‚   â”‚     â”‚  â”œâ”€ Forward Pass
         â”‚   â”‚     â”‚  â”‚  â”œâ”€ è¼¸å…¥é®ç½©åºåˆ—
         â”‚   â”‚     â”‚  â”‚  â””â”€ é æ¸¬è¢«é®ç½©é …ç›®
         â”‚   â”‚     â”‚  â”œâ”€ è¨ˆç®— Loss (CrossEntropyLoss)
         â”‚   â”‚     â”‚  â”œâ”€ è¨ˆç®— Top-K Accuracy
         â”‚   â”‚     â”‚  â”‚  â”œâ”€ Top-1: ç¬¬ä¸€åæº–ç¢ºç‡
         â”‚   â”‚     â”‚  â”‚  â”œâ”€ Top-5: å‰äº”åæº–ç¢ºç‡
         â”‚   â”‚     â”‚  â”‚  â”œâ”€ Top-10: å‰ååæº–ç¢ºç‡
         â”‚   â”‚     â”‚  â”‚  â””â”€ Top-20: å‰äºŒååæº–ç¢ºç‡
         â”‚   â”‚     â”‚  â”œâ”€ Backward Pass
         â”‚   â”‚     â”‚  â””â”€ æ›´æ–°åƒæ•¸
         â”‚   â”‚     â”‚
         â”‚   â”‚     â”œâ”€ é©—è­‰éšæ®µ
         â”‚   â”‚     â”‚  â”œâ”€ è¨ˆç®—é©—è­‰ Loss
         â”‚   â”‚     â”‚  â””â”€ è¨ˆç®—é©—è­‰ Top-K Accuracy
         â”‚   â”‚     â”‚
         â”‚   â”‚     â”œâ”€ è¨˜éŒ„æŒ‡æ¨™
         â”‚   â”‚     â”‚  â”œâ”€ train_losses.append(loss)
         â”‚   â”‚     â”‚  â”œâ”€ val_losses.append(loss)
         â”‚   â”‚     â”‚  â”œâ”€ train_accuracies[k].append(acc)
         â”‚   â”‚     â”‚  â””â”€ val_accuracies[k].append(acc)
         â”‚   â”‚     â”‚
         â”‚   â”‚     â””â”€ å„²å­˜æ¨¡å‹
         â”‚   â”‚        â”œâ”€ æ¯ 10 epochs â†’ checkpoint
         â”‚   â”‚        â””â”€ æœ€ä½³é©—è­‰ Loss â†’ best_model.pth
         â”‚   â”‚
         â”‚   â”œâ”€ ç¬¬äº”æ­¥: è¨“ç·´å®Œæˆ
         â”‚   â”‚  â”œâ”€ å„²å­˜æœ€çµ‚æ¨¡å‹
         â”‚   â”‚  â”‚  â””â”€â–º output/models/final_model.pth
         â”‚   â”‚  â”œâ”€ å„²å­˜æ˜ å°„è³‡æ–™
         â”‚   â”‚  â”‚  â””â”€â–º output/models/item_mappings.pkl
         â”‚   â”‚  â””â”€ å„²å­˜è¨“ç·´é…ç½®
         â”‚   â”‚     â””â”€â–º output/models/training_config.json
         â”‚   â”‚
         â”‚   â””â”€ ç¬¬å…­æ­¥: ç”Ÿæˆè¦–è¦ºåŒ–
         â”‚      â”œâ”€ loss_curve.png
         â”‚      â”‚  â””â”€ è¨“ç·´/é©—è­‰ Loss æ›²ç·š
         â”‚      â”œâ”€ accuracy_curve.png
         â”‚      â”‚  â””â”€ Top-1/5/10/20 æº–ç¢ºç‡æ›²ç·š
         â”‚      â”œâ”€ combined_metrics.png
         â”‚      â”‚  â””â”€ ç¶œåˆæŒ‡æ¨™ (4 åˆ 1)
         â”‚      â”œâ”€ learning_curve.png
         â”‚      â”‚  â””â”€ å¹³æ»‘å­¸ç¿’æ›²ç·š
         â”‚      â””â”€ training_metrics.json
         â”‚         â””â”€ å®Œæ•´è¨“ç·´æŒ‡æ¨™
         â”‚
         â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®Œæˆï¼è¨“ç·´çµæœ                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

output/
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ best_model.pth          â† æœ€ä½³æ¨¡å‹ (æ¨è–¦ä½¿ç”¨)
â”‚   â”œâ”€â”€ final_model.pth         â† æœ€çµ‚æ¨¡å‹
â”‚   â”œâ”€â”€ item_mappings.pkl       â† é …ç›®æ˜ å°„
â”‚   â””â”€â”€ training_config.json    â† è¨“ç·´é…ç½®
â”‚
â”œâ”€â”€ plots/
â”‚   â”œâ”€â”€ loss_curve.png          â† Loss æ›²ç·šåœ–
â”‚   â”œâ”€â”€ accuracy_curve.png      â† æº–ç¢ºç‡æ›²ç·šåœ–
â”‚   â”œâ”€â”€ combined_metrics.png    â† ç¶œåˆæŒ‡æ¨™åœ– â­
â”‚   â”œâ”€â”€ learning_curve.png      â† å­¸ç¿’æ›²ç·šåœ–
â”‚   â””â”€â”€ training_metrics.json   â† å®Œæ•´æŒ‡æ¨™ JSON
â”‚
â”œâ”€â”€ checkpoints/
â”‚   â”œâ”€â”€ checkpoint_epoch_10.pth
â”‚   â”œâ”€â”€ checkpoint_epoch_20.pth
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ logs/
    â””â”€â”€ training.log            â† è¨“ç·´æ—¥èªŒ
```

## ğŸ”„ æ•¸æ“šæµè½‰åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AniList API â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â–º 3000 éƒ¨å‹•ç•«
       â”‚   â””â”€â–º data/bert.db (bert_anime è¡¨)
       â”‚
       â””â”€â–º N å€‹ç”¨æˆ¶çš„è§€çœ‹è¨˜éŒ„
           â””â”€â–º data/bert.db (bert_user_anime_list è¡¨)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ data/bert.db â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â–º è®€å–å‹•ç•«åˆ—è¡¨ â†’ item_to_idx æ˜ å°„
       â”‚
       â””â”€â–º è®€å–ç”¨æˆ¶åºåˆ— â†’ user_sequences
           â”‚
           â”œâ”€â–º åˆ†å‰² â†’ è¨“ç·´é›† (90%)
           â”‚          â”‚
           â”‚          â””â”€â–º BERT4RecDataset â†’ DataLoader
           â”‚                                    â”‚
           â”‚                                    â””â”€â–º è¨“ç·´æ¨¡å‹
           â”‚
           â””â”€â–º åˆ†å‰² â†’ é©—è­‰é›† (10%)
                      â”‚
                      â””â”€â–º BERT4RecDataset â†’ DataLoader
                                               â”‚
                                               â””â”€â–º é©—è­‰æ¨¡å‹

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¨“ç·´æ¨¡å‹    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â–º output/models/ (æ¨¡å‹æ–‡ä»¶)
       â”œâ”€â–º output/plots/ (åœ–è¡¨)
       â”œâ”€â–º output/checkpoints/ (æª¢æŸ¥é»)
       â””â”€â–º training.log (æ—¥èªŒ)
```

## ğŸ“ æ¨¡å‹æ¶æ§‹åœ–

```
è¼¸å…¥åºåˆ—: [anime_1, anime_2, [MASK], anime_4, ...]
   â”‚
   â”œâ”€â–º Item Embedding (256-dim)
   â”‚   â””â”€ [emb_1, emb_2, emb_mask, emb_4, ...]
   â”‚
   â”œâ”€â–º Position Embedding (256-dim)
   â”‚   â””â”€ [pos_0, pos_1, pos_2, pos_3, ...]
   â”‚
   â”œâ”€â–º ç›¸åŠ  + LayerNorm + Dropout
   â”‚   â””â”€ [h_1, h_2, h_3, h_4, ...]
   â”‚
   â”œâ”€â–º Transformer Encoder (x2 å±¤)
   â”‚   â”œâ”€ Multi-Head Attention (4 heads)
   â”‚   â”œâ”€ Feed Forward Network
   â”‚   â””â”€ Residual Connection + LayerNorm
   â”‚   â””â”€ [hidden_1, hidden_2, hidden_3, ...]
   â”‚
   â”œâ”€â–º Output Layer (Linear)
   â”‚   â””â”€ [logits_1, logits_2, logits_3, ...] (æ¯å€‹ logits å¤§å° = num_items)
   â”‚
   â””â”€â–º é æ¸¬è¢«é®ç½©ä½ç½®
       â”œâ”€ è¨ˆç®— Loss (CrossEntropyLoss)
       â””â”€ è¨ˆç®— Top-K Accuracy
```

## ğŸ¯ æº–ç¢ºç‡è¨ˆç®—é‚è¼¯

```
å°æ–¼æ¯å€‹è¢«é®ç½©çš„ä½ç½®:

1. ç²å–é æ¸¬ logits: [score_1, score_2, ..., score_N]
2. æ’åºç²å– Top-K é …ç›®: [top_1, top_2, ..., top_k]
3. æª¢æŸ¥çœŸå¯¦æ¨™ç±¤æ˜¯å¦åœ¨ Top-K ä¸­

Top-1 Accuracy:  çœŸå¯¦æ¨™ç±¤ == top_1 ? 1 : 0
Top-5 Accuracy:  çœŸå¯¦æ¨™ç±¤ in [top_1, ..., top_5] ? 1 : 0
Top-10 Accuracy: çœŸå¯¦æ¨™ç±¤ in [top_1, ..., top_10] ? 1 : 0
Top-20 Accuracy: çœŸå¯¦æ¨™ç±¤ in [top_1, ..., top_20] ? 1 : 0

æœ€çµ‚æº–ç¢ºç‡ = Î£(æ­£ç¢ºé æ¸¬) / Î£(ç¸½é æ¸¬æ•¸)
```

## ğŸ“Š è¦–è¦ºåŒ–æµç¨‹

```
è¨“ç·´éç¨‹ä¸­è¨˜éŒ„:
â”œâ”€ train_losses: [8.23, 7.89, 7.45, ...]
â”œâ”€ val_losses: [8.12, 7.76, 7.31, ...]
â”œâ”€ train_accuracies: 
â”‚  â”œâ”€ top-1: [0.023, 0.034, 0.045, ...]
â”‚  â”œâ”€ top-5: [0.112, 0.145, 0.178, ...]
â”‚  â””â”€ ...
â””â”€ val_accuracies:
   â”œâ”€ top-1: [0.029, 0.038, 0.051, ...]
   â””â”€ ...

è¨“ç·´çµæŸå¾Œç”Ÿæˆ:
â”œâ”€ loss_curve.png
â”‚  â””â”€ plt.plot(epochs, train_losses)
â”‚     plt.plot(epochs, val_losses)
â”‚
â”œâ”€ accuracy_curve.png
â”‚  â””â”€ å°æ¯å€‹ K: plt.plot(epochs, accuracies[k])
â”‚
â”œâ”€ combined_metrics.png (2x2 å­åœ–)
â”‚  â”œâ”€ Loss æ›²ç·š
â”‚  â”œâ”€ è¨“ç·´æº–ç¢ºç‡
â”‚  â”œâ”€ é©—è­‰æº–ç¢ºç‡
â”‚  â””â”€ Top-K æ¯”è¼ƒæŸ±ç‹€åœ–
â”‚
â””â”€ training_metrics.json
   â””â”€ JSON.dump(æ‰€æœ‰æŒ‡æ¨™)
```

## â±ï¸ æ™‚é–“ä¼°ç®—

```
éšæ®µ 0: ç’°å¢ƒæº–å‚™
â”œâ”€ setup.bat
â””â”€ é è¨ˆæ™‚é–“: 5-10 åˆ†é˜

éšæ®µ 1: æº–å‚™å‹•ç•«æ•¸æ“š
â”œâ”€ 1_prepare_anime.bat
â”‚  â””â”€ æŠ“å– 3000 éƒ¨å‹•ç•«
â””â”€ é è¨ˆæ™‚é–“: 10-20 åˆ†é˜

éšæ®µ 2: è¼‰å…¥ç”¨æˆ¶æ•¸æ“š
â”œâ”€ 2_load_users.bat
â”‚  â””â”€ å‡è¨­ 50 å€‹ç”¨æˆ¶
â””â”€ é è¨ˆæ™‚é–“: 5-15 åˆ†é˜

éšæ®µ 3: æ¨¡å‹è¨“ç·´ (200 epochs)
â”œâ”€ CPU ç‰ˆæœ¬
â”‚  â”œâ”€ æ¯ epoch: 1-3 åˆ†é˜
â”‚  â””â”€ ç¸½æ™‚é–“: 3-10 å°æ™‚
â”‚
â””â”€ GPU ç‰ˆæœ¬ (GTX 1060+)
   â”œâ”€ æ¯ epoch: 10-30 ç§’
   â””â”€ ç¸½æ™‚é–“: 30 åˆ†é˜ - 2 å°æ™‚

ç¸½æ™‚é–“ä¼°ç®—:
â”œâ”€ CPU: 4-11 å°æ™‚
â””â”€ GPU: 1-3 å°æ™‚
```

## ğŸ”„ ä¸€éµåŸ·è¡Œæµç¨‹

```
åŸ·è¡Œ run_all.bat:

Step 1: prepare_dataset.py
   â†“
   ç­‰å¾…å®Œæˆ
   â†“
Step 2: load_users.py
   â†“
   ç­‰å¾…å®Œæˆ
   â†“
Step 3: train_model.py
   â†“
   ç­‰å¾…å®Œæˆ (æœ€é•·)
   â†“
å®Œæˆï¼è‡ªå‹•ç”Ÿæˆæ‰€æœ‰è¼¸å‡º
```

## ğŸ“ˆ è¨“ç·´ç›£æ§æŒ‡æ¨™

```
æ¯å€‹ Epoch è¼¸å‡º:

Epoch 1/200
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
è¨“ç·´ä¸­: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:32<00:00]
  è¨“ç·´ Loss: 8.2341        â† æ‡‰é€æ¼¸ä¸‹é™
  è¨“ç·´ Top-1 Acc: 0.0234   â† æ‡‰é€æ¼¸ä¸Šå‡
  è¨“ç·´ Top-5 Acc: 0.1123   â† æ‡‰é€æ¼¸ä¸Šå‡
  è¨“ç·´ Top-10 Acc: 0.1856  â† æ‡‰é€æ¼¸ä¸Šå‡

é©—è­‰ä¸­: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:02<00:00]
  é©—è­‰ Loss: 8.1234        â† æ‡‰é€æ¼¸ä¸‹é™
  é©—è­‰ Top-1 Acc: 0.0289   â† æ‡‰é€æ¼¸ä¸Šå‡
  é©—è­‰ Top-5 Acc: 0.1267   â† æ‡‰é€æ¼¸ä¸Šå‡
  é©—è­‰ Top-10 Acc: 0.1943  â† æ‡‰é€æ¼¸ä¸Šå‡
  ğŸŒŸ æ–°çš„æœ€ä½³æ¨¡å‹ï¼        â† ç•¶é©—è­‰ Loss æ›´ä½æ™‚
```

## âœ… é©—è­‰æµç¨‹æ­£ç¢ºæ€§

### æ•¸æ“šæº–å‚™éšæ®µ âœ“
1. prepare_dataset.py æ­£ç¢ºæŠ“å– 3000 éƒ¨å‹•ç•« âœ“
2. load_users.py æ­£ç¢ºå¾ datas_user.txt è®€å–ç”¨æˆ¶ âœ“
3. æ•¸æ“šæ­£ç¢ºå„²å­˜åˆ° data/bert.db âœ“

### è¨“ç·´éšæ®µ âœ“
1. æ­£ç¢ºè¼‰å…¥è³‡æ–™åº«æ•¸æ“š âœ“
2. æ­£ç¢ºå»ºç«‹æ˜ å°„å’Œåºåˆ— âœ“
3. æ­£ç¢ºå¯¦ç¾ BERT4Rec æ¨¡å‹ âœ“
4. æ­£ç¢ºè¨ˆç®— Loss å’Œ Top-K Accuracy âœ“
5. æ­£ç¢ºå„²å­˜æ¨¡å‹å’Œæª¢æŸ¥é» âœ“

### è¦–è¦ºåŒ–éšæ®µ âœ“
1. æ­£ç¢ºè¨˜éŒ„æ‰€æœ‰æŒ‡æ¨™ âœ“
2. æ­£ç¢ºç”Ÿæˆ 4 ç¨®åœ–è¡¨ âœ“
3. æ­£ç¢ºå„²å­˜ JSON æ ¼å¼æŒ‡æ¨™ âœ“

## ğŸ‰ çµè«–

é€™å€‹è¨“ç·´æ¶æ§‹æ˜¯ï¼š
- âœ… å®Œæ•´çš„ (å¾æ•¸æ“šåˆ°æ¨¡å‹)
- âœ… çœŸå¯¦çš„ (ä½¿ç”¨çœŸå¯¦ AniList æ•¸æ“š)
- âœ… å¯ç”¨çš„ (200 epochs è¨“ç·´é…ç½®)
- âœ… æœ‰è¦–è¦ºåŒ–çš„ (Loss å’Œ Accuracy åœ–è¡¨)
- âœ… æ˜“æ–¼ä½¿ç”¨çš„ (ä¸€éµæˆ–åˆ†æ­¥åŸ·è¡Œ)

ç«‹å³é–‹å§‹è¨“ç·´: `setup.bat` â†’ `run_all.bat`
